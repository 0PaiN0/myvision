!function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t){e.exports=fabric},function(e,t,n){"use strict";n.r(t);var o=n(0),i=n.n(o);function r(e){e.forEachObject(e=>{e.selectable=!0}),e.defaultCursor="default",e.hoverCursor="move"}function s(e,t){const n=document.getElementById("labelNamePopUp");n.style.display="block";const o=document.getElementById("canvas-wrapper").getBoundingClientRect(),i=o.top,r=o.left;n.style.top=`${t+i}px`,n.style.left=`${e+r}px`}function a(){document.getElementById("labelNamePopUp").style.display="none"}const c={},l={inProgress:!1};let u=null,d=null,f=0;function g(e,t){u=e,d=t,l.inProgress=!0}function h(){const e=document.getElementById("label-title").value;r(d),a(),u.set("id",f),"bndBoxTemp"===u.shapeName&&u.set({fill:"rgba(255,0,0,0.1)",shapeName:"bndBox"}),f+=1,c[u[u.id]]=e,l.inProgress=!1}function m(e){e.discardActiveObject(),e.renderAll(),e.forEachObject(e=>{e.selectable=!1}),e.defaultCursor="crosshair",e.hoverCursor="crosshair"}let p=null,b=!1,w=!1;const y={};function x(e){(p=e).backgroundImage&&(b=!0,m(p),p.discardActiveObject()),e.on("mouse:down",()=>{!function(){if(b){w=!0;const e=p.getPointer(p.e);y.origX=e.x,y.origY=e.y,y.rect=new i.a.Rect(function(e,t){return{left:e.origX,top:e.origY,width:t.x-e.origX,height:t.y-e.origY,stroke:"rgba(255,0,0)",strokeWidth:2,fill:"rgba(255,0,0,0)",shapeName:"bndBoxTemp"}}(y,e)),p.add(y.rect)}}()}),e.on("mouse:move",e=>{!function(e){if(!w)return;const t=p.getPointer(e.e);y.origX>t.x&&y.rect.set({left:Math.abs(t.x)}),y.origY>t.y&&y.rect.set({top:Math.abs(t.y)}),y.rect.set({width:Math.abs(y.origX-t.x)}),y.rect.set({height:Math.abs(y.origY-t.y)}),p.renderAll()}(e)}),e.on("mouse:up",e=>{!function(e){if(w){b=!1,w=!1,y.rect.setCoords(),y.rect.selectable=!1,r(p);const t=p.getPointer(e.e);g(y.rect,p),s(t.x,t.y)}}(e)})}const v={};function P(e,t,n){const o=n.getPointer(t.e);return{radius:3,fill:"#ffffff",stroke:"#333333",strokeWidth:.5,left:o.x,top:o.y,selectable:!0,hasBorders:!1,hasControls:!1,originX:"center",originY:"center",shapeName:"tempPoint",pointId:e,objectCaching:!1}}function C(e,t){return{radius:3,fill:"blue",stroke:"#333333",strokeWidth:.5,left:t.x,top:t.y,selectable:!0,hasBorders:!1,hasControls:!1,originX:"center",originY:"center",shapeName:"point",objectCaching:!1,pointId:e}}v.newPolygon={stroke:"rgba(255,0,0)",strokeWidth:1.75,fill:"rgba(237, 237, 237, 0.01)",perPixelTargetFind:!0,hasBorders:!1,hasControls:!1,shapeName:"polygon",selectable:!1,evented:!0,objectCaching:!1},v.newTempPolygon={stroke:"#333333",strokeWidth:.8,fill:"#cccccc",opacity:.3,selectable:!1,hasBorders:!1,hasControls:!1,evented:!1,objectCaching:!1},v.newLine={strokeWidth:1.1,fill:"#999999",stroke:"#999999",class:"line",originX:"center",originY:"center",selectable:!1,hasBorders:!1,hasControls:!1,evented:!1,objectCaching:!1},v.firstPoint={fill:"red",shapeName:"firstPoint"},v.newPoint=P,v.existingPolygonPoint=C;let j=null,_=[],O=[],k=!0,N=null,A=!1,B=0;function E(){O.forEach(e=>{j.remove(e)}),j.remove(A).remove(N)}function L(){_[0]&&(_.forEach(e=>{j.remove(e)}),E(),_=[],O=[],A=null,N=null,B=0)}function W(e){e.target&&e.target.shapeName&&"firstPoint"===e.target.shapeName&&function(e){const t=[];_.forEach(e=>{t.push({x:e.left,y:e.top}),j.remove(e)}),E();const n=new i.a.Polygon(t,v.newPolygon);j.add(n),N=null,A=null,k=!1;const o=j.getPointer(e.e);g(n,j),s(o.x,o.y)}(e),k&&function(e){const t=j.getPointer(e.e),n=new i.a.Circle(v.newPoint(B,e,j));B+=1,0===_.length&&n.set(v.firstPoint);let o=[t.x,t.y,t.x,t.y];const r=new i.a.Line(o,v.newLine);if(A){(o=A.get("points")).push({x:t.x,y:t.y});const e=new i.a.Polygon(o,v.newTempPolygon);j.remove(A),j.add(e),A=e,j.renderAll()}else{const e=[{x:t.x,y:t.y}],n=new i.a.Polygon(e,v.newTempPolygon);A=n,j.add(n)}N=r,_.push(n),O.push(r),j.add(n),j.selection=!1}(e)}function I(e){j=e,k=!0,L(),j.discardActiveObject(),m(j),e.on("mouse:down",e=>{(!e.target||e.target&&"tempPoint"!==e.target.shapeName)&&W(e)}),e.on("object:moving",e=>{!function(e){A.points[e.target.pointId]={x:e.target.getCenterPoint().x,y:e.target.getCenterPoint().y}}(e)}),e.on("mouse:move",e=>{!function(e){if(N&&"line"===N.class){const t=j.getPointer(e.e);N.set({x2:t.x,y2:t.y});const n=A.get("points");n[_.length]={x:t.x,y:t.y},A.set({points:n}),j.renderAll()}j.renderAll()}(e)}),e.on("mouse:over",t=>{t.target&&t.target.selectable?e.hoverCursor="move":e.hoverCursor="crosshair"})}let M,U,X=null,T=[],Y=null,$=null;function H(e,t,n,o){!function(e,t,n,o){X=e,T=t,Y=n,$=o}(e,t,n,o);const r=function(){const e=new i.a.Polygon([],$.newPolygon);return e.set({id:X.id,selectable:!0}),e}();Y.add(r);const s=function(e){let t=0;const n=[];return e.forEach(e=>{const o=new i.a.Circle($.existingPolygonPoint(t,e));Y.add(o),T.push(o),n.push({x:o.left-1,y:o.top-1}),t+=1}),n}(function(){const e=X.calcTransformMatrix();return X.get("points").map(e=>new i.a.Point(e.x-X.pathOffset.x,e.y-X.pathOffset.y)).map(t=>i.a.util.transformPoint(t,e))}());return Y.remove(X),(X=r).set("points",s),function(){const e=X._calcDimensions();X.set({left:e.left,top:e.top,height:e.height,width:e.width,pathOffset:{x:e.left+e.width/2,y:e.top+e.height/2}}),X.setCoords(),Y.renderAll()}(),X}let R=[];const S=[];function D(){U=H(U,R,M,v)}function F(e,t){M=e,U=t}function z(e,t){F(e,t),e.discardActiveObject(),function(){let e=0;U.get("points").forEach(t=>{const n=new i.a.Circle(v.existingPolygonPoint(e,t));M.add(n),R.push(n),e+=1})}()}function q(){0!==R.length&&(R.forEach(e=>{M.remove(e),S.push(e)}),M.renderAll(),R=[])}let G=!1,J=!1,K=!1,Q=null,V=!1;function Z(e,t){var n,o;V?(n=t,o=e.target,F(n,o),n.discardActiveObject(),D(),Q=e.target.id):D(),J=!1,G=!0}function ee(){!function(){const e=U._calcDimensions();U.set({left:e.left,top:e.top,height:e.height,width:e.width,pathOffset:{x:e.left+e.width/2,y:e.top+e.height/2}}),U.setCoords(),M.renderAll()}(),K=!1}function te(){q(),G=!1,Q=null}function ne(e,t){J?Z(e,t):V?function(e,t){G&&q(),z(t,e.target),Q=e.target.id,G=!0}(e,t):K?ee():!e.target&&G&&te()}function oe(e){e.target&&("polygon"===e.target.shapeName?(G&&(q(),G=!1),J=!0):"point"===e.target.shapeName&&(!function(e){const{left:t}=e.target,{top:n}=e.target,o=e.target;U.points[o.pointId]={x:t,y:n}}(e),K=!0))}function ie(e){e.on("mouse:down",e=>{!function(e){e.target?"bndBox"===e.target.shapeName&&G?(te(),V=!1):V="polygon"===e.target.shapeName&&e.target.id!==Q:V=!1}(e)}),e.on("mouse:up",t=>{ne(t,e)}),e.on("object:moving",e=>{oe(e)}),e.on("mouse:over",t=>{t.target&&"point"!==t.target.shapeName&&(t.target.set("fill","rgba(255,0,0,0.2)"),e.renderAll())}),e.on("mouse:out",t=>{t.target&&"point"!==t.target.shapeName&&("bndBox"===t.target.shapeName?t.target.set("fill","rgba(255,0,0,0"):"polygon"===t.target.shapeName&&t.target.set("fill","rgba(255,0,0,0.01)"),e.renderAll())})}function re(e){e.__eventListeners&&(e.__eventListeners["mouse:down"]=[],e.__eventListeners["mouse:over"]=[],e.__eventListeners["mouse:out"]=[],e.__eventListeners["mouse:move"]=[],e.__eventListeners["mouse:up"]=[],e.__eventListeners["object:moving"]=[])}let se=null,ae=!1;function ce(){re(se),x(se),ae=!1}function le(){re(se),I(se),ae=!1}function ue(){se.remove(se.getActiveObject())}function de(){ae||(re(se),r(se),ie(se),ae=!0)}const fe={uploaded:!1,name:null},ge={};let he=null;function me(e,t){t?function(e,t){he.setWidth(t.width),he.setHeight(t.height),i.a.Image.fromURL(e.src,e=>{he.setBackgroundImage(e,he.renderAll.bind(he),{scaleX:he.width/e.width,scaleY:he.height/e.height})})}(e,t):function(e){he.setWidth(e.width),he.setHeight(e.height),he.setBackgroundColor({source:e.src},()=>{he.renderAll()})}(e)}function pe(e){const t={},n=ge.maximumCanvasWidth/e.width;return t.width=ge.maximumCanvasWidth,t.height=e.height*n,t}function be(){fe.uploaded=!0;const e=this;if(ge.maximumCanvasHeight<e.height){let t=function(e){const t={},n=ge.maximumCanvasHeight/e.height;return t.height=ge.maximumCanvasHeight,t.width=e.width*n,t}(e);ge.maximumCanvasWidth<t.width&&(t=pe(t)),me(e,t)}else if(ge.maximumCanvasWidth<e.width){me(e,pe(e))}else me(e)}function we(e){const t=new Image;t.src=e.target.result,t.onload=be}function ye(e){he=e,ge.maximumCanvasHeight=window.innerHeight-54,ge.maximumCanvasWidth=window.innerWidth-110}function xe(e){return function e(t){let n="";return Object.keys(t).forEach(o=>{"object"==typeof t[o]?n+=`<${o}>${e(t[o])}</${o}>`:n+=`<${o}>${t[o]}</${o}>`}),n}(e)}let ve=null;function Pe(e){const t=document.createElement("a"),n=new Blob([e],{type:"text/plain"});return t.setAttribute("href",window.URL.createObjectURL(n)),t.setAttribute("download",`${new RegExp("^([^.]+)").exec(fe.name)[0]}.xml`),t.dataset.downloadurl=["text/plain",t.download,t.href].join(":"),t.draggable=!0,t.classList.add("dragout"),t}function Ce(){if(ve.backgroundImage){!function(e){Pe(e).click()}(xe(function(e,t){const n={};return n.annotations=function(e,t){return{folder:"Unknown",filename:t.name,path:"Unknown",source:{database:"Unknown"},size:{width:e.getWidth(),height:e.getHeight(),depth:1},segmented:0}}(e,t),n.annotations.object=function(e){let t={};return e.forEachObject(e=>{const n=e._objects[0],o=e._objects[1].text;t={name:o,pose:"Unspecified",truncated:1,difficult:0,bndbox:{xmin:n.left,ymin:n.top,xmax:n.left+n.width,ymax:n.top+n.height}}}),t}(e),n}(ve,fe)))}}function je(){h(),de()}function _e(){l.inProgress&&(a(),d.remove(u),l.inProgress=!1,l.inProgress=!1)}function Oe(){L(),_e(),q()}function ke(e){Oe(),e&&e()}function Ne(e){Oe(),function(e){if(e.files&&e.files[0]){const t=new FileReader;fe.name=e.files[0].name,t.onload=we,t.readAsDataURL(e.files[0])}}(e)}!function(){const e=new i.a.Canvas("c",{selection:!1});i.a.Object.prototype.transparentCorners=!1,se=e,ye(e),function(e){ve=e}(e)}(),function(){window.createNewBndBox=ke.bind(this,ce),window.createNewPolygon=ke.bind(this,le),window.removeShape=ke.bind(this,ue),window.downloadXML=ke.bind(this,Ce),window.cancel=ke.bind(this,de),window.uploadImage=Ne,window.labelShape=je}()}]);